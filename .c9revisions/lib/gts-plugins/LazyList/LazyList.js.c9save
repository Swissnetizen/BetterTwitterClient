{"ts":1352569241623,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"/**\n\tA List that loads its items lazily. When the user scroll to the end of the list, it asks for more items to add, and shows feedback accordingly.\n\n\t## Basic Use\n\n\tSame as standard list component, but you can use lazyLoad() method to load the first set of data.\n\n\tThe onAcquirePage event enabled lazy data retrieval. It gets fired each time the user reachs the end of the list. Return true if there are more items to add, false otherwise:\n\n\t\tcomponents: [\n\t\t\t{kind: \"LazyList\", fit: true, onSetupItem: \"setupItem\", onAcquirePage: \"lazyLoad\", components: [\n\t\t\t\t{classes: \"item\", ontap: \"itemTap\", components: [\n\t\t\t\t\t{name: \"name\"},\n\t\t\t\t\t{name: \"index\", style: \"float: right;\"}\n\t\t\t\t]}\n\t\t\t]}\n\t\t],\n\t\tlazyLoad: function( inSender, inEvent ) {\n\t\t\tvar page = inEvent.page;\n\n\t\t\tif(this.itemsCount > this.$.lazyList.getCount() ) {\n\t\t\t\tthis.askForData(inPage );\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tgotData: function( inRequest, inResponse ) {\n\t\t\tthis.results = this.results.concat( inResponse.results );\n\t\t\tthis.$.list.setCount( this.results.length );\n\t\t}\n\n*/\n\n/**\n * @name GTS.LazyList\n * @author Newness (Rafa Bernad)\n * @author Matthew Schott <glitchtechscience@gmail.com>\n *\n * Lazy loading list. Found in a merge request on the official enyo github.\n * Included in here to make use of it until an official solution is released.\n * Released under the gts namespace to prevent future conflicts. Code cleaned\n * up some and changed to my needs.\n *\n * @class\n * @extends enyo.List\n * @see http://enyojs.com\n */\nenyo.kind({\n\tname: \"GTS.LazyList\",\n\tkind: \"enyo.AroundList\",\n\n\tlastLazyLoad: 0,\n\n\tpublished: {\n\t\t/** @lends GTS.LazyList# */\n\n\t\t/**\n\t\t * Page size\n\t\t * @type int\n\t\t * @default 50\n\t\t */\n\t\tpageSize: 50\n\t},\n\n\t/**\n\t * @public\n\t * Events sent by control\n\t */\n\tevents: {\n\t\t/** @lends GTS.LazyList# */\n\n\t\t/**\n\t\t * Aquire new pages of data\n\t\t * @event\n\t\t * @param {Object} inSender\tEvent's sender\n\t\t * @param {Object} inEvent\tEvent parameters\n\t\t */\n\t\tonAcquirePage: \"\"\n\t},\n/*\n\tlistTools: [\n\t\t{\n\t\t\tname: \"port\",\n\t\t\tclasses: \"enyo-list-port enyo-border-box\",\n\t\t\tcomponents: [\n\t\t\t\t{\n\t\t\t\t\tname: \"aboveClient\"\n\t\t\t\t}, {\n\t\t\t\t\tname: \"generator\",\n\t\t\t\t\tkind: \"enyo.FlyweightRepeater\",\n\t\t\t\t\tcanGenerate: false,\n\t\t\t\t\tcomponents: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttag: null,\n\t\t\t\t\t\t\tname: \"client\"\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}, {\n\t\t\t\t\tname: \"page0\",\n\t\t\t\t\tallowHtml: true,\n\t\t\t\t\tclasses: \"enyo-list-page\"\n\t\t\t\t}, {\n\t\t\t\t\tname: \"page1\",\n\t\t\t\t\tallowHtml: true,\n\t\t\t\t\tclasses: \"enyo-list-page\"\n\t\t\t\t}, {\n\t\t\t\t\tname: \"belowClient\"\n\t\t\t\t}\n\t\t\t]\n\t\t}, {\n\t\t\tname: \"lazyFeedback\",\n\t\t\tclasses: \"enyo-lazy-feedback\"\n\t\t}\n\t],\n*/\n\t/**\n\t * @private\n\t * @function\n\t * @name GTS.LazyList#scroll\n\t * @extends enyo.List#scroll\n\t *\n\t * Overrides scroll to check for & request new data\n\t *\n\t * @param {object} inSender\tThe event sender\n\t * @param {object} inEvent\tEvent object\n\t */\n\tscroll: function( inSender, inEvent ) {\n\n\t\tvar s = this.getStrategy().$.scrollMath;\n\n\t\tif( ( s.isInOverScroll() && s.y < 0 ) || ( s.y <( s.bottomBoundary + this.$['belowClient'].hasNode().offsetHeight ) ) ) {\n\n\t\t\tif( this.lastLazyLoad < this.pageCount ) {\n\n\t\t\t\tthis.lastLazyLoad = this.pageCount;\n\n\t\t\t\tvar bMore = this.doAcquirePage( {\n\t\t\t\t\t\t\"page\": this.lastLazyLoad,\n\t\t\t\t\t\t\"pageSize\": this.pageSize\n\t\t\t\t\t});\n\n\t\t\t\tthis.log( bMore, new Date() );\n\n\t\t\t\t//this.$['lazyFeedback'].addRemoveClass( \"enyo-loading\", bMore );\n\t\t\t\t//this.$['lazyFeedback'].addRemoveClass( \"enyo-eol\", !bMore );\n\t\t\t}\n\t\t}\n\n\t\treturn this.inherited( arguments );\n\t},\n\n\t/**\n\t * @public\n\t * @function\n\t * @name GTS.LazyList#lazyLoad\n\t *\n\t * Resets list position and fetches new data\n\t */\n\tlazyLoad: function() {\n\n\t\tthis.lastLazyLoad = 0;\n\n\t\tthis.doAcquirePage( { \"page\": this.lastLazyLoad, \"pageSize\": this.pageSize } );\n\t},\n\n\t/**\n\t * @public\n\t * @function\n\t * @name GTS.LazyList#refresh\n\t * @extends enyo.List#refresh\n\t */\n\trefresh: function() {\n\n\t\t//this.$['lazyFeedback'].removeClass( \"enyo-loading\" );\n\t\t//this.$['lazyFeedback'].addRemoveClass( \"enyo-eol\", this.$['lazyFeedback'].hasClass( \"enyo-eol\" ) );\n\n\t\tthis.inherited( arguments );\n\t},\n\n\t/**\n\t * @public\n\t * @function\n\t * @name GTS.LazyList#reset\n\t * @extends enyo.List#reset\n\t */\n\treset: function() {\n\n\t\t//this.$['lazyFeedback'].removeClass( \"enyo-loading\" );\n\t\t//this.$['lazyFeedback'].removeClass( \"enyo-eol\" );\n\n\t\tthis.inherited( arguments );\n\n\t}\n});\n"]],"start1":0,"start2":0,"length1":0,"length2":4314}]],"length":4314}
